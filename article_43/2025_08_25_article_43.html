<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard de Vendas em Tempo Real com Python, FastAPI e WebSockets — Cara Core Informática</title>
  <meta name="description" content="Dashboard de vendas e estoque em tempo real com FastAPI, WebSockets e Chart.js. Layout responsivo, atualização automática e arquitetura profissional." />
  <meta name="keywords" content="Dashboard Tempo Real, FastAPI, WebSockets, Python, Chart.js, Vendas, Estoque, Data Visualization" />
  <meta name="author" content="Cara Core Informática" />
  <link rel="canonical" href="https://caracore.com.br/publications/articles/2025_08_25_article_43.html" />
  <!-- Open Graph -->
  <meta property="og:title" content="Dashboard de Vendas em Tempo Real com Python, FastAPI e WebSockets" />
  <meta property="og:description" content="Sistema completo de dashboard com atualizações em tempo real, gráficos interativos e arquitetura profissional." />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://caracore.com.br/publications/articles/2025_08_25_article_43.html" />
  <meta property="og:image" content="https://caracore.com.br/publications/articles/media/article_43_01.png" />
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Dashboard de Vendas em Tempo Real com Python, FastAPI e WebSockets" />
  <meta name="twitter:description" content="Sistema profissional com FastAPI, WebSockets e Chart.js." />
  <meta name="twitter:image" content="https://caracore.com.br/publications/articles/media/article_43_01.png" />
  <link rel="stylesheet" href="css/articles.css" />
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; line-height:1.55; color:#1f2937; margin:0; }
    .container { max-width: 980px; margin:0 auto; padding:2rem 1.25rem 4rem; }
    h1 { line-height:1.2; font-size:clamp(1.9rem,2.4vw,2.5rem); margin-top:0; }
    h2 { margin-top:2.25rem; line-height:1.25; }
    pre { background:#0f172a; color:#f1f5f9; padding:1rem 1.1rem; overflow:auto; border-radius:8px; font-size:.85rem; }
    code { font-family: ui-monospace,SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace; }
    figure img { max-width:100%; height:auto; }
    ul,ol { padding-left:1.1rem; }
    .back-link { text-decoration:none; font-size:.85rem; color:#2563eb; }
    .note { background:#f8f9fa; padding:1rem 1.25rem; border-left:4px solid #10B981; border-radius:6px; }
    .hash-box { background:#f8f9fa; padding:1rem 1.25rem; border-left:4px solid #0EA5E9; border-radius:6px; font-size:.85rem; line-height:1.5; }
    .repo-box { background:#f8f9fa; padding:1.25rem 1.25rem 1rem; border-left:4px solid #10B981; border-radius:6px; }
    .repo-box a { color:#10B981; font-weight:600; text-decoration:none; }
    hr { border:none; border-top:1px solid #e5e7eb; margin:3rem 0 2rem; }
    @media (max-width:640px){ pre { font-size:.78rem; } }
  </style>
</head>
<body>
  <div class="container">
    <a class="back-link" href="../articles.html">&larr; Voltar para publicações</a>
    <img src="media/article_43_01.png" alt="Dashboard de vendas em tempo real" style="max-width:300px; float:right; margin:0 0 1.5rem 2rem; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,.08);" />
    <h1>Dashboard de Vendas em Tempo Real com Python, FastAPI e WebSockets</h1>
    <div style="display:flex; align-items:center; gap:.75rem; margin-bottom:1.25rem;">
      <img src="media/logo.png" alt="Logo Cara Core" style="width:42px; height:42px; object-fit:contain;" />
      <div style="font-size:.82rem; color:#555;">
        <strong>Cara Core Informática</strong><br />82 seguidores • 25 de agosto de 2025
      </div>
    </div>

    <p>Este artigo apresenta um sistema completo de dashboard de vendas que atualiza automaticamente em tempo real. Usando FastAPI, WebSockets e Chart.js v4.4.1, construímos uma solução profissional para monitorar vendas e estoque de maneira contínua.</p>

    <div class="note"><strong>Projeto implementado:</strong> Monitoramento de arquivo CSV exportado do Excel, detecção de alterações, push via WebSocket para todos os navegadores conectados, layout responsivo, gráficos (pizza + séries temporais) e fallback automático para polling.</div>

    <h2>Arquitetura do Sistema</h2>
    <ul>
      <li>Monitoramento automático de arquivo CSV (watchdog + polling)</li>
      <li>API REST para snapshot e histórico</li>
      <li>Canal WebSocket para atualizações em tempo real</li>
      <li>Interface responsiva com Chart.js (v4.4.1)</li>
      <li>Fallback inteligente para polling</li>
      <li>Logging estruturado JSON com rotação</li>
      <li>Layout "dashboard-layout" focado em visualização</li>
    </ul>

    <h2>Objetivos</h2>
    <ul>
      <li>Comparar vendas em janelas de tempo</li>
      <li>Identificar produtos com maior e menor giro</li>
      <li>Antecipar reposição de estoque</li>
      <li>Expor métricas de forma simples e clara</li>
    </ul>

    <h2>Componentes da Interface</h2>
    <ul>
      <li>Cards de métricas (vendas totais, linhas, última atualização)</li>
      <li>Gráfico de pizza principal (distribuição por produto)</li>
      <li>Gráficos de linha (histórico de vendas e estoque)</li>
      <li>Sidebar de tabelas (vendas e estoque por produto)</li>
      <li>Status de conexão (WebSocket / Polling)</li>
      <li>Atualização reativa em segundos após alterações</li>
    </ul>

    <h2>Estrutura de Dados</h2>
    <p>O arquivo CSV segue a estrutura:</p>
    <pre><code>timestamp,produto,vendas,estoque
2025-08-15 14:30:00,Produto A,120,45
2025-08-15 14:33:00,Produto B,85,32
2025-08-15 14:36:00,Produto C,95,28
2025-08-15 14:39:00,Produto D,110,15
2025-08-15 14:42:00,Produto E,75,22</code></pre>

    <h2>Configuração Rápida</h2>
    <pre><code class="language-bash">git clone https://github.com/chmulato/cara-core-dashboard.git
cd cara-core-dashboard
pip install -r requirements.txt
python main.py</code></pre>

    <h2>Backend (Trecho Simplificado)</h2>
    <pre><code class="language-python">from fastapi import FastAPI, WebSocket, WebSocketDisconnect
import asyncio

app = FastAPI()

class Manager:
    def __init__(self):
        self.clients: list[WebSocket] = []
        self._lock = asyncio.Lock()

    async def connect(self, ws: WebSocket):
        await ws.accept()
        async with self._lock:
            self.clients.append(ws)

    async def disconnect(self, ws: WebSocket):
        async with self._lock:
            if ws in self.clients:
                self.clients.remove(ws)

manager = Manager()

@app.websocket('/ws')
async def ws_endpoint(ws: WebSocket):
    await manager.connect(ws)
    try:
        while True:
            await ws.receive_text()  # keep-alive
    except WebSocketDisconnect:
        await manager.disconnect(ws)</code></pre>

    <h2>Frontend (Trecho)</h2>
    <pre><code class="language-javascript">const state = { ws:null, charts:{}, reconnect:0, maxReconnect:10 };
function connect(){
  state.ws = new WebSocket(`ws://${location.host}/ws`);
  state.ws.onopen = () => { state.reconnect = 0; };
  state.ws.onclose = () => {
    if(state.reconnect < state.maxReconnect){
      setTimeout(connect, 1500); state.reconnect++; return;
    }
    // fallback: iniciar polling
  };
}
connect();</code></pre>

    <h2>Layout (CSS Core)</h2>
    <pre><code class="language-css">.dashboard-layout{display:grid;grid-template-columns:1fr 300px;gap:2rem}
.chart-pizza{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
.chart-container{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:1.25rem}
.chart-row{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}
@media (max-width:780px){.dashboard-layout{grid-template-columns:1fr}.chart-row{grid-template-columns:1fr}}</code></pre>

    <h2>Estrutura do Projeto</h2>
    <pre><code class="language-text">cara-core-dashboard/
├── main.py
├── app/
│   ├── main.py
│   ├── data_loader.py
│   ├── logging_setup.py
│   ├── sample_data.csv
│   ├── templates/index.html
│   └── static/
├── src/
│   ├── generate_batch_data.py
│   ├── update_simulator.py
│   └── quick_demo_data.py
├── tests/
├── requirements.txt
├── Dockerfile
└── README.md</code></pre>

    <h2>Execução & Deploy</h2>
    <pre><code class="language-bash">python main.py                          # Porta 8000 (ou próxima livre)
LOG_LEVEL=DEBUG LOG_FORMAT=plain python main.py  # Logs detalhados
docker build -t dashboard-vendas .
docker run -p 8001:8000 dashboard-vendas</code></pre>

    <figure style="margin:2rem 0; text-align:center;">
      <img src="media/article_43_03.png" alt="Screenshot final do dashboard" style="max-width:820px; width:100%; border-radius:10px; box-shadow:0 4px 20px -4px rgba(0,0,0,0.15);" />
      <figcaption style="font-size:.8rem; color:#555; margin-top:.55rem;">Interface final responsiva (gráfico pizza, séries temporais e tabelas).</figcaption>
    </figure>

    <h2>Checklist</h2>
    <ul>
      <li>✅ CSV padronizado</li>
      <li>✅ Watchdog + Polling</li>
      <li>✅ WebSocket com reconexão</li>
      <li>✅ Gráficos Chart.js</li>
      <li>✅ Layout responsivo</li>
      <li>✅ Logging estruturado</li>
      <li>✅ Dockerfile</li>
    </ul>

    <h2>Repositório</h2>
    <div class="repo-box">
      <p style="margin:0 0 .5rem 0; font-weight:600;">GitHub:</p>
      <a href="https://github.com/chmulato/cara-core-dashboard" target="_blank" rel="noopener">https://github.com/chmulato/cara-core-dashboard</a>
      <p style="margin:.75rem 0 0; font-size:.8rem; color:#555;">Licença MIT • Python • FastAPI • Chart.js</p>
    </div>

    <h2>Hashtags</h2>
    <div class="hash-box">#DashboardTempoReal #FastAPI #WebSockets #ChartJS #PythonDashboard #DataVisualization #RealtimeDashboard #BusinessIntelligence #DataAnalytics #PythonWeb #DashboardInterativo</div>

    <hr />
    <h3>Contato</h3>
    <ul>
      <li><strong>E-mail:</strong> suporte@caracore.com.br</li>
      <li><strong>Site:</strong> <a href="https://www.caracore.com.br" target="_blank" rel="noopener">www.caracore.com.br</a></li>
      <li><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/company/cara-core/" target="_blank" rel="noopener">Cara Core Informática</a></li>
    </ul>
  </div>
</body>
</html>
